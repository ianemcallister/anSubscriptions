var ahNuts=angular.module("ansub",["ui.bootstrap"]);function mainController(s,e,i,t){var r={name:{first:"",last:""},address:{street1:"",street2:"",street3:"",city:"",state:"",zip:""},contact:{},relationship:""},a={yearly:[{id:1,name:"Treat",shipDay:"",billDay:""}],quarterly:[{id:1,name:"Winter",shipDay:"",billDay:""},{id:2,name:"Spring",shipDay:"",billDay:""},{id:3,name:"Summer",shipDay:"",billDay:""},{id:4,name:"Fall",shipDay:"",billDay:""}],monthly:[{id:1,name:"January",shipDay:"3rd",billDay:"1st"},{id:2,name:"February",shipDay:"3rd",billDay:"1st"},{id:3,name:"March",shipDay:"3rd",billDay:"1st"},{id:4,name:"April",shipDay:"3rd",billDay:"1st"},{id:5,name:"May",shipDay:"3rd",billDay:"1st"},{id:6,name:"June",shipDay:"3rd",billDay:"1st"},{id:7,name:"July",shipDay:"3rd",billDay:"1st"},{id:8,name:"August",shipDay:"3rd",billDay:"1st"},{id:9,name:"September",shipDay:"3rd",billDay:"1st"},{id:10,name:"October",shipDay:"3rd",billDay:"1st"},{id:11,name:"November",shipDay:"3rd",billDay:"1st"},{id:12,name:"December",shipDay:"3rd",billDay:"1st"}],weekly:function(){for(var e=[],i=1;i<=52;i++){var t="Week "+i;e.push({id:i,name:t,shipDay:"Tuesday",billDay:"Friday"})}return e}()};function n(i){var e=Object.create(r),t=!1,a=0,n=0;return s.userData.recipiantList.forEach(function(e){e.relationship==i&&(t=!0,a=n),n++}),t||(e.relationship=i,s.userData.recipiantList.push(e)),a}function o(i){var t=0;return s.userData.recipiantList.forEach(function(e){e.relationship==i&&s.userData.recipiantList.splice(t,1),t++}),0}function c(e){s.state.selectedRecipiant=e}s.flavors=[{name:"Secret Recipe Pecans",description:" "},{name:"Secret Recipe Almonds",description:" "},{name:"Secret Recipe Cashews",description:" "},{name:"Secret Recipe Peanuts",description:" "},{name:"Cinnamon Pecans",description:" "},{name:"Cinnamon Almonds",description:" "},{name:"Drunken Pecans",description:" "},{name:"Mix-It-Up",description:" "}],s.orderSchedule=[{id:1}],s.userData={name:{first:"",last:""},contact:{email:"",phone:""},shippingDestination:{street:"",city:"",state:"",zip:""},order:[]},s.state={tempRecipiant:{name:{first:"",last:""},address:{street1:"",street2:"",street3:"",city:"",state:"",zip:""},contact:{email:"",phone:""},relationship:""},order:{qty:"1",visibility:{one:!0,two:!1,three:!1,four:!1}},frequency:{value:"monthly"},shippingDestinations:"1",recipientsBox:"1",recipiantSelected:{state:!1,id:""},subType:{},selectedRecipiant:0,errors:{missingRequired:!1}},s.updateOrderVisiblity=function(i){var t={one:1,two:2,three:3,four:4};Object.keys(s.state.order.visibility).forEach(function(e){s.state.order.visibility[e]=t[e]<=i})},s.updateFrequency=function(e){s.userData.shippingSchedule=a[e]},s.updateOrderSchedule=function(e){},s.updateSubType=function(e){"myself"==(s.userData.subType=e)?(n("Myself"),o("Someone"),c(0)):"others"==e?(n("Someone"),o("Myself"),c(0)):"both"==e&&(n("Myself"),n("Someone"),c(0))},s.selectRecipiant=function(e){c(e),s.state.tempRecipiant=s.userData.recipiantList[e]},s.updateRecipiantValues=function(){var e=s.state.selectedRecipiant;s.userData.recipiantList[e]=s.state.tempRecipiant},s.validateForm=function(){console.log("validating form",s.userData),s.state.errors.missingRequired=!0,t.submit(s.userData).then(function(e){console.log("got this response",e)}).catch(function(e){})}}function modalService(e){var n={backdrop:!0,keyboard:!0,modalFade:!0,templateUrl:"partials/modal.htm"},s={closeButtonText:"Close",actionButtonText:"OK",headerText:"Proceed?",bodyText:"Perform this action?"};this.showModal=function(e,i){return e||(e={}),e.backdrop="static",this.show(e,i)},this.show=function(e,i){var t={},a={};return angular.extend(t,n,e),angular.extend(a,s,i),t.controller||(t.controller=function(e,i){e.modalOptions=a,e.modalOptions.ok=function(e){i.close(e)},e.modalOptions.close=function(e){i.dismiss("cancel")}}),$modal.open(t).result}}function submissionService(a){this.submit=function(e){return console.log("submitting",e),new Promise(function(i,t){a({method:"POST",url:"/subscription-application-submission",headers:{"Content-Type":"application/json"},data:e}).then(function(e){i(e)},function(e){t(e)})})}}function zipcomplete(){this.handleResp=function(e){e.error_msg?console.log(e.error_msg):"city"in e&&(container.find("input[name='city']").val(e.city),container.find("input[name='state']").val(e.state))},this.checkZip=function(e){var i=e.substring(0,5);5==i.length&&/^[0-9]+$/.test(i)&&console.log("checking zip",i)}}angular.module("ansub").controller("mainController",mainController),mainController.$inject=["$scope","$log","modalService","submissionService"],angular.module("ansub").service("modalService",modalService),modalService.$inject=["$uibModal"],angular.module("ansub").service("submissionService",submissionService),submissionService.$inject=["$http"],angular.module("ansub").service("zipcomplete",zipcomplete),zipcomplete.$inject=[];
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvd2ViYXBwLmpzIiwic2NyaXB0cy9jb250cm9sbGVycy9tYWluLmNvbnRyb2xsZXIuanMiLCJzY3JpcHRzL3NlcnZpY2VzL21vcmRhbHMuc2VydmljZS5qcyIsInNjcmlwdHMvc2VydmljZXMvc3VibWlzc2lvblNlcml2Y2Uuc2VydmljZS5qcyIsInNjcmlwdHMvc2VydmljZXMvemlwY29tcGxldGUuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJhaE51dHMiLCJhbmd1bGFyIiwibW9kdWxlIiwibWFpbkNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkbG9nIiwibW9kYWxTZXJ2aWNlIiwic3VibWlzc2lvblNlcnZpY2UiLCJyZWNpcGlhbnRQcm9maWxlIiwibmFtZSIsImZpcnN0IiwibGFzdCIsImFkZHJlc3MiLCJzdHJlZXQxIiwic3RyZWV0MiIsInN0cmVldDMiLCJjaXR5Iiwic3RhdGUiLCJ6aXAiLCJjb250YWN0IiwicmVsYXRpb25zaGlwIiwic2hpcHBpbmdTY2hlZHVsZXMiLCJ5ZWFybHkiLCJpZCIsInNoaXBEYXkiLCJiaWxsRGF5IiwicXVhcnRlcmx5IiwibW9udGhseSIsIndlZWtseSIsImFsbFdlZWtzIiwiaSIsIndlZWtOYW1lIiwicHVzaCIsIndlZWtseUdlbmVyYXRvciIsImFkZFRvUmVjaXBpYW50TGlzdCIsIm5ld1JlY2lwaWFudCIsIk9iamVjdCIsImNyZWF0ZSIsImV4aXN0c0FscmVhZHkiLCJlbnRyeUluZGV4IiwidXNlckRhdGEiLCJyZWNpcGlhbnRMaXN0IiwiZm9yRWFjaCIsInJlY2lwaWFudCIsInJlbW92ZUZyb21SZWNpcGlhbnRMaXN0Iiwic3BsaWNlIiwic2VsZWN0UmVjaXBpYW50IiwiaW5kZXgiLCJzZWxlY3RlZFJlY2lwaWFudCIsImZsYXZvcnMiLCJkZXNjcmlwdGlvbiIsIm9yZGVyU2NoZWR1bGUiLCJlbWFpbCIsInBob25lIiwic2hpcHBpbmdEZXN0aW5hdGlvbiIsInN0cmVldCIsIm9yZGVyIiwidGVtcFJlY2lwaWFudCIsInF0eSIsInZpc2liaWxpdHkiLCJvbmUiLCJ0d28iLCJ0aHJlZSIsImZvdXIiLCJmcmVxdWVuY3kiLCJ2YWx1ZSIsInNoaXBwaW5nRGVzdGluYXRpb25zIiwicmVjaXBpZW50c0JveCIsInJlY2lwaWFudFNlbGVjdGVkIiwic3ViVHlwZSIsImVycm9ycyIsIm1pc3NpbmdSZXF1aXJlZCIsInVwZGF0ZU9yZGVyVmlzaWJsaXR5IiwiaGFzaCIsImtleXMiLCJrZXkiLCJ1cGRhdGVGcmVxdWVuY3kiLCJzaGlwcGluZ1NjaGVkdWxlIiwidXBkYXRlT3JkZXJTY2hlZHVsZSIsInVwZGF0ZVN1YlR5cGUiLCJ1cGRhdGVSZWNpcGlhbnRWYWx1ZXMiLCJ2YWxpZGF0ZUZvcm0iLCJjb25zb2xlIiwibG9nIiwic3VibWl0IiwidGhlbiIsInJlc3BvbnNlIiwiY2F0Y2giLCJlIiwiJHVpYk1vZGFsIiwibW9kYWxEZWZhdWx0cyIsImJhY2tkcm9wIiwia2V5Ym9hcmQiLCJtb2RhbEZhZGUiLCJ0ZW1wbGF0ZVVybCIsIm1vZGFsT3B0aW9ucyIsImNsb3NlQnV0dG9uVGV4dCIsImFjdGlvbkJ1dHRvblRleHQiLCJoZWFkZXJUZXh0IiwiYm9keVRleHQiLCJ0aGlzIiwic2hvd01vZGFsIiwiY3VzdG9tTW9kYWxEZWZhdWx0cyIsImN1c3RvbU1vZGFsT3B0aW9ucyIsInNob3ciLCJ0ZW1wTW9kYWxEZWZhdWx0cyIsInRlbXBNb2RhbE9wdGlvbnMiLCJleHRlbmQiLCJjb250cm9sbGVyIiwiJG1vZGFsSW5zdGFuY2UiLCJvayIsInJlc3VsdCIsImNsb3NlIiwiZGlzbWlzcyIsIiRtb2RhbCIsIm9wZW4iLCIkaHR0cCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwibWV0aG9kIiwidXJsIiwiaGVhZGVycyIsIkNvbnRlbnQtVHlwZSIsImRhdGEiLCJlcnJvciIsInppcGNvbXBsZXRlIiwiaGFuZGxlUmVzcCIsImVycm9yX21zZyIsImNvbnRhaW5lciIsImZpbmQiLCJ2YWwiLCJjaGVja1ppcCIsImVudGVyZWRaaXAiLCJ6aXBjb2RlIiwic3Vic3RyaW5nIiwibGVuZ3RoIiwidGVzdCIsIiRpbmplY3QiLCJzZXJ2aWNlIl0sIm1hcHBpbmdzIjoiQUFFQSxJQUFBQSxPQUFBQyxRQUFBQyxPQUFBLFFBQUEsQ0FBQSxpQkNHQSxTQUFBQyxlQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUVBLElBQUFDLEVBQUEsQ0FDQUMsS0FBQSxDQUNBQyxNQUFBLEdBQ0FDLEtBQUEsSUFFQUMsUUFBQSxDQUNBQyxRQUFBLEdBQ0FDLFFBQUEsR0FDQUMsUUFBQSxHQUNBQyxLQUFBLEdBQ0FDLE1BQUEsR0FDQUMsSUFBQSxJQUVBQyxRQUFBLEdBQ0FDLGFBQUEsSUFHQUMsRUFBQSxDQUNBQyxPQUFBLENBQ0EsQ0FBQUMsR0FBQSxFQUFBZCxLQUFBLFFBQUFlLFFBQUEsR0FBQUMsUUFBQSxLQUVBQyxVQUFBLENBQ0EsQ0FBQUgsR0FBQSxFQUFBZCxLQUFBLFNBQUFlLFFBQUEsR0FBQUMsUUFBQSxJQUNBLENBQUFGLEdBQUEsRUFBQWQsS0FBQSxTQUFBZSxRQUFBLEdBQUFDLFFBQUEsSUFDQSxDQUFBRixHQUFBLEVBQUFkLEtBQUEsU0FBQWUsUUFBQSxHQUFBQyxRQUFBLElBQ0EsQ0FBQUYsR0FBQSxFQUFBZCxLQUFBLE9BQUFlLFFBQUEsR0FBQUMsUUFBQSxLQUVBRSxRQUFBLENBQ0EsQ0FBQUosR0FBQSxFQUFBZCxLQUFBLFVBQUFlLFFBQUEsTUFBQUMsUUFBQSxPQUNBLENBQUFGLEdBQUEsRUFBQWQsS0FBQSxXQUFBZSxRQUFBLE1BQUFDLFFBQUEsT0FDQSxDQUFBRixHQUFBLEVBQUFkLEtBQUEsUUFBQWUsUUFBQSxNQUFBQyxRQUFBLE9BQ0EsQ0FBQUYsR0FBQSxFQUFBZCxLQUFBLFFBQUFlLFFBQUEsTUFBQUMsUUFBQSxPQUNBLENBQUFGLEdBQUEsRUFBQWQsS0FBQSxNQUFBZSxRQUFBLE1BQUFDLFFBQUEsT0FDQSxDQUFBRixHQUFBLEVBQUFkLEtBQUEsT0FBQWUsUUFBQSxNQUFBQyxRQUFBLE9BQ0EsQ0FBQUYsR0FBQSxF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LFFBQUFDLE9BQUEsU0FBQTBHLFdBQUEsaUJBQUF6RyxnQkFFQUEsZUFBQXVJLFFBQUEsQ0FBQSxTQUFBLE9BQUEsZUFBQSxxQkNGQXpJLFFBQUFDLE9BQUEsU0FBQXlJLFFBQUEsZUFBQXJJLGNBR0FBLGFBQUFvSSxRQUFBLENBQUEsYUNIQXpJLFFBQUFDLE9BQUEsU0FBQXlJLFFBQUEsb0JBQUFwSSxtQkFHQUEsa0JBQUFtSSxRQUFBLENBQUEsU0NIQXpJLFFBQUFDLE9BQUEsU0FBQXlJLFFBQUEsY0FBQWIsYUFHQUEsWUFBQVksUUFBQSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL2RlZmluZSB0aGUgbW9kdWxlXG5cbnZhciBhaE51dHMgPSBhbmd1bGFyLm1vZHVsZSgnYW5zdWInLCBbJ3VpLmJvb3RzdHJhcCddKTsiLCJhbmd1bGFyLm1vZHVsZSgnYW5zdWInKS5jb250cm9sbGVyKCdtYWluQ29udHJvbGxlcicsIG1haW5Db250cm9sbGVyKTtcblxuXHRtYWluQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCckbG9nJywgJ21vZGFsU2VydmljZScsICdzdWJtaXNzaW9uU2VydmljZSddO1xuXG5cdC8qIEBuZ0luamVjdCAqL1xuXHRmdW5jdGlvbiBtYWluQ29udHJvbGxlcigkc2NvcGUsICRsb2csIG1vZGFsU2VydmljZSwgc3VibWlzc2lvblNlcnZpY2UpIHtcblx0XHQvL2RlZmluZSBsb2NhbCB2YXJpYWJsZXNcblx0XHR2YXIgcmVjaXBpYW50UHJvZmlsZSA9IHtcblx0XHRcdG5hbWU6IHtcblx0XHRcdFx0Zmlyc3Q6IFwiXCIsXG5cdFx0XHRcdGxhc3Q6IFwiXCJcblx0XHRcdH0sXG5cdFx0XHRhZGRyZXNzOiB7XG5cdFx0XHRcdHN0cmVldDE6IFwiXCIsXG5cdFx0XHRcdHN0cmVldDI6IFwiXCIsXG5cdFx0XHRcdHN0cmVldDM6IFwiXCIsXG5cdFx0XHRcdGNpdHk6IFwiXCIsXG5cdFx0XHRcdHN0YXRlOiBcIlwiLFxuXHRcdFx0XHR6aXA6IFwiXCJcblx0XHRcdH0sXG5cdFx0XHRjb250YWN0OiB7fSxcblx0XHRcdHJlbGF0aW9uc2hpcDogXCJcIlxuXHRcdH07XG5cblx0XHR2YXIgc2hpcHBpbmdTY2hlZHVsZXMgPSB7XG5cdFx0XHRcInllYXJseVwiOiBbXG5cdFx0XHRcdHsgaWQ6IDEsIG5hbWU6IFwiVHJlYXRcIiwgc2hpcERheTogXCJcIiwgYmlsbERheTogXCJcIiB9XG5cdFx0XHRdLFxuXHRcdFx0XCJxdWFydGVybHlcIjogW1xuXHRcdFx0XHR7IGlkOiAxLCBuYW1lOiBcIldpbnRlclwiLCBzaGlwRGF5OiBcIlwiLCBiaWxsRGF5OiBcIlwiIH0sXG5cdFx0XHRcdHsgaWQ6IDIsIG5hbWU6IFwiU3ByaW5nXCIsIHNoaXBEYXk6IFwiXCIsIGJpbGxEYXk6IFwiXCIgfSxcblx0XHRcdFx0eyBpZDogMywgbmFtZTogXCJTdW1tZXJcIiwgc2hpcERheTogXCJcIiwgYmlsbERheTogXCJcIiB9LFxuXHRcdFx0XHR7IGlkOiA0LCBuYW1lOiBcIkZhbGxcIiwgc2hpcERheTogXCJcIiwgYmlsbERheTogXCJcIiB9XG5cdFx0XHRdLFxuXHRcdFx0XCJtb250aGx5XCI6IFtcblx0XHRcdFx0eyBpZDogMSwgbmFtZTogXCJKYW51YXJ5XCIsIHNoaXBEYXk6IFwiM3JkXCIsIGJpbGxEYXk6IFwiMXN0XCIgfSxcblx0XHRcdFx0eyBpZDogMiwgbmFtZTogXCJGZWJydWFyeVwiLCBzaGlwRGF5OiBcIjNyZFwiLCBiaWxsRGF5OiBcIjFzdFwiIH0sXG5cdFx0XHRcdHsgaWQ6IDMsIG5hbWU6IFwiTWFyY2hcIiwgc2hpcERheTogXCIzcmRcIiwgYmlsbERheTogXCIxc3RcIiB9LFxuXHRcdFx0XHR7IGlkOiA0LCBuYW1lOiBcIkFwcmlsXCIsIHNoaXBEYXk6IFwiM3JkXCIsIGJpbGxEYXk6IFwiMXN0XCIgfSxcblx0XHRcdFx0eyBpZDogNSwgbmFtZTogXCJNYXlcIiwgc2hpcERheTogXCIzcmRcIiwgYmlsbERheTogXCIxc3RcIiB9LFxuXHRcdFx0XHR7IGlkOiA2LCBuYW1lOiBcIkp1bmVcIiwgc2hpcERheTogXCIzcmRcIiwgYmlsbERheTogXCIxc3RcIiB9LFxuXHRcdFx0XHR7IGlkOiA3LCBuYW1lOiBcIkp1bHlcIiwgc2hpcERheTogXCIzcmRcIiwgYmlsbERheTogXCIxc3RcIiB9LFxuXHRcdFx0XHR7IGlkOiA4LCBuYW1lOiBcIkF1Z3VzdFwiLCBzaGlwRGF5OiBcIjNyZFwiLCBiaWxsRGF5OiBcIjFzdFwiIH0sXG5cdFx0XHRcdHsgaWQ6IDksIG5hbWU6IFwiU2VwdGVtYmVyXCIsIHNoaXBEYXk6IFwiM3JkXCIsIGJpbGxEYXk6IFwiMXN0XCIgfSxcblx0XHRcdFx0eyBpZDogMTAsIG5hbWU6IFwiT2N0b2JlclwiLCBzaGlwRGF5OiBcIjNyZFwiLCBiaWxsRGF5OiBcIjFzdFwiIH0sXG5cdFx0XHRcdHsgaWQ6IDExLCBuYW1lOiBcIk5vdmVtYmVyXCIsIHNoaXBEYXk6IFwiM3JkXCIsIGJpbGxEYXk6IFwiMXN0XCIgfSxcblx0XHRcdFx0eyBpZDogMTIsIG5hbWU6IFwiRGVjZW1iZXJcIiwgc2hpcERheTogXCIzcmRcIiwgYmlsbERheTogXCIxc3RcIiB9XG5cdFx0XHRdLFxuXHRcdFx0XCJ3ZWVrbHlcIjogd2Vla2x5R2VuZXJhdG9yKClcblxuXHRcdH1cblx0XHRcblx0XHR2YXIgc2hpcHBpbmdPY2N1cmFuY2UgPSB7XG5cdFx0XHRpZDogMCxcblx0XHRcdG5hbWU6IFwiXCIsXG5cdFx0XHRkYXRlOiBcIlwiXG5cdFx0fTtcblxuXHRcdGZ1bmN0aW9uIHdlZWtseUdlbmVyYXRvcigpIHtcblx0XHRcdC8vZGVmaW5lIGxvY2FsIHZhcmlhYmxlc1xuXHRcdFx0dmFyIGFsbFdlZWtzID0gW107XG5cblx0XHRcdGZvcih2YXIgaSA9IDE7IGkgPD0gNTI7IGkrKykge1xuXHRcdFx0XHR2YXIgd2Vla05hbWUgPSBcIldlZWsgXCIgKyBpO1xuXHRcdFx0XHRhbGxXZWVrcy5wdXNoKHsgaWQ6IGksIG5hbWU6IHdlZWtOYW1lLCBzaGlwRGF5OiBcIlR1ZXNkYXlcIiwgYmlsbERheTogXCJGcmlkYXlcIiB9KTtcblx0XHRcdH07XG5cblx0XHRcdHJldHVybiBhbGxXZWVrcztcblx0XHR9O1xuXG5cdFx0Ly9kZWZpbmUgZmxhdm9yIHZhcmlhYmxlc1xuXHRcdCRzY29wZS5mbGF2b3JzPSBbXG5cdFx0XHR7IG5hbWU6ICdTZWNyZXQgUmVjaXBlIFBlY2FucycsIGRlc2NyaXB0aW9uOiBcIiBcIiB9LFxuXHRcdFx0eyBuYW1lOiAnU2VjcmV0IFJlY2lwZSBBbG1vbmRzJywgZGVzY3JpcHRpb246IFwiIFwiIH0sXG5cdFx0XHR7IG5hbWU6ICdTZWNyZXQgUmVjaXBlIENhc2hld3MnLCBkZXNjcmlwdGlvbjogXCIgXCIgfSxcblx0XHRcdHsgbmFtZTogJ1NlY3JldCBSZWNpcGUgUGVhbnV0cycsIGRlc2NyaXB0aW9uOiBcIiBcIiB9LFxuXHRcdFx0eyBuYW1lOiAnQ2lubmFtb24gUGVjYW5zJywgZGVzY3JpcHRpb246IFwiIFwiIH0sXG5cdFx0XHR7IG5hbWU6ICdDaW5uYW1vbiBBbG1vbmRzJywgZGVzY3JpcHRpb246IFwiIFwiIH0sXG5cdFx0XHR7IG5hbWU6ICdEcnVua2VuIFBlY2FucycsIGRlc2NyaXB0aW9uOiBcIiBcIiB9LFxuXHRcdFx0eyBuYW1lOiAnTWl4LUl0LVVwJywgZGVzY3JpcHRpb246IFwiIFwiIH1cblx0XHRdO1xuXG5cdFx0JHNjb3BlLm9yZGVyU2NoZWR1bGUgPSBbXG5cdFx0XHR7IGlkOiAxIH1cblx0XHRdO1xuXG5cdFx0Ly9kZWZpbmUgdXNlcmRhdGEgbW9kZWwgdmFyaWFibGVcblx0XHQkc2NvcGUudXNlckRhdGEgPSB7XG5cdFx0XHRuYW1lOiB7XG5cdFx0XHRcdGZpcnN0OiBcIlwiLFxuXHRcdFx0XHRsYXN0OiBcIlwiXG5cdFx0XHR9LFxuXHRcdFx0Y29udGFjdDoge1xuXHRcdFx0XHRlbWFpbDogXCJcIixcblx0XHRcdFx0cGhvbmU6IFwiXCJcblx0XHRcdH0sXG5cdFx0XHRzaGlwcGluZ0Rlc3RpbmF0aW9uOiB7XG5cdFx0XHRcdHN0cmVldDogXCJcIixcblx0XHRcdFx0Y2l0eTogXCJcIixcblx0XHRcdFx0c3RhdGU6IFwiXCIsXG5cdFx0XHRcdHppcDogXCJcIlxuXHRcdFx0fSxcblx0XHRcdG9yZGVyOiBbXVxuXHRcdFx0Ly9zaGlwcGluZ1NjaGVkdWxlOiBzaGlwcGluZ1NjaGVkdWxlcy5tb250aGx5XG5cdFx0fTtcblxuXHRcdC8vZGVmaW5lIHN0YXRlIHZhcmlhYmxlc1xuXHRcdCRzY29wZS5zdGF0ZSA9IHtcblx0XHRcdHRlbXBSZWNpcGlhbnQ6IHtcblx0XHRcdFx0bmFtZToge1xuXHRcdFx0XHRcdGZpcnN0OiBcIlwiLFxuXHRcdFx0XHRcdGxhc3Q6IFwiXCJcblx0XHRcdFx0fSxcblx0XHRcdFx0YWRkcmVzczoge1xuXHRcdFx0XHRcdHN0cmVldDE6IFwiXCIsXG5cdFx0XHRcdFx0c3RyZWV0MjogXCJcIixcblx0XHRcdFx0XHRzdHJlZXQzOiBcIlwiLFxuXHRcdFx0XHRcdGNpdHk6IFwiXCIsXG5cdFx0XHRcdFx0c3RhdGU6IFwiXCIsXG5cdFx0XHRcdFx0emlwOiBcIlwiXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGNvbnRhY3Q6IHtcblx0XHRcdFx0XHRlbWFpbDogXCJcIixcblx0XHRcdFx0XHRwaG9uZTogXCJcIlxuXHRcdFx0XHR9LFxuXHRcdFx0XHRyZWxhdGlvbnNoaXA6IFwiXCJcblx0XHRcdH0sXG5cdFx0XHRvcmRlcjoge1xuXHRcdFx0XHRxdHk6IFwiMVwiLFxuXHRcdFx0XHR2aXNpYmlsaXR5OiB7XG5cdFx0XHRcdFx0b25lOiB0cnVlLFxuXHRcdFx0XHRcdHR3bzogZmFsc2UsXG5cdFx0XHRcdFx0dGhyZWU6IGZhbHNlLFxuXHRcdFx0XHRcdGZvdXI6IGZhbHNlLFxuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0ZnJlcXVlbmN5OiB7XG5cdFx0XHRcdHZhbHVlOiAnbW9udGhseSdcblx0XHRcdH0sXG5cdFx0XHRzaGlwcGluZ0Rlc3RpbmF0aW9uczogXCIxXCIsXG5cdFx0XHRyZWNpcGllbnRzQm94OiBcIjFcIixcblx0XHRcdHJlY2lwaWFudFNlbGVjdGVkOiB7XG5cdFx0XHRcdHN0YXRlOiBmYWxzZSxcblx0XHRcdFx0aWQ6IFwiXCJcblx0XHRcdH0sXG5cdFx0XHRzdWJUeXBlOiB7fSxcblx0XHRcdHNlbGVjdGVkUmVjaXBpYW50OiAwLFxuXHRcdFx0ZXJyb3JzOiB7XG5cdFx0XHRcdG1pc3NpbmdSZXF1aXJlZDogZmFsc2Vcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvL2xvY2FsIGZ1bmN0aW9uc1xuXHRcdGZ1bmN0aW9uIGFkZFRvUmVjaXBpYW50TGlzdChyZWxhdGlvbnNoaXApIHtcblx0XHRcdFxuXHRcdFx0Ly9kZWZpbmUgbG9jYWwgdmFyaWFibGVzXG5cdFx0XHR2YXIgbmV3UmVjaXBpYW50ID0gT2JqZWN0LmNyZWF0ZShyZWNpcGlhbnRQcm9maWxlKTtcblx0XHRcdHZhciBleGlzdHNBbHJlYWR5ID0gZmFsc2U7XG5cdFx0XHR2YXIgZW50cnlJbmRleCA9IDA7XG5cdFx0XHR2YXIgaSA9IDA7XG5cblx0XHRcdC8vMS4gY2hlY2sgZm9yIHRoZSByZWxhdGlvbnNoaXBcblx0XHRcdCRzY29wZS51c2VyRGF0YS5yZWNpcGlhbnRMaXN0LmZvckVhY2goZnVuY3Rpb24ocmVjaXBpYW50KSB7XG5cdFx0XHRcdGlmKHJlY2lwaWFudC5yZWxhdGlvbnNoaXAgPT0gcmVsYXRpb25zaGlwKSB7XG5cdFx0XHRcdFx0ZXhpc3RzQWxyZWFkeSA9IHRydWU7XG5cdFx0XHRcdFx0ZW50cnlJbmRleCA9IGk7XG5cdFx0XHRcdH07XG5cdFx0XHRcdGkrKztcblx0XHRcdH0pO1xuXG5cdFx0XHQvL2NvbnNvbGUubG9nKCdhZGRpbmcnLCByZWxhdGlvbnNoaXAsICd0byByZWNpcGlhbnQgbGlzdCcsICRzY29wZS51c2VyRGF0YS5yZWNpcGlhbnRMaXN0LCBcImFscmVhZHkgRXhpc3RzP1wiLCBleGlzdHNBbHJlYWR5KTtcblxuXHRcdFx0Ly9pZiByZWxhdGlvbnNoaXAgZG9lc24ndCBleGlzdCB5ZXQsIGFkZCBpdFxuXHRcdFx0aWYoIWV4aXN0c0FscmVhZHkpIHtcblx0XHRcdFx0bmV3UmVjaXBpYW50LnJlbGF0aW9uc2hpcCA9IHJlbGF0aW9uc2hpcDtcblx0XHRcdFx0JHNjb3BlLnVzZXJEYXRhLnJlY2lwaWFudExpc3QucHVzaChuZXdSZWNpcGlhbnQpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvL3JldHVybiByZXN1bHRcblx0XHRcdHJldHVybiBlbnRyeUluZGV4O1xuXHRcdH07XG5cblx0XHRmdW5jdGlvbiByZW1vdmVGcm9tUmVjaXBpYW50TGlzdChyZWxhdGlvbnNoaXApIHtcblx0XHRcdFxuXHRcdFx0Ly9jb25zb2xlLmxvZygncmVtb3ZpbmcnLCByZWxhdGlvbnNoaXAsICd0byByZWNpcGlhbnQgbGlzdCcpO1xuXG5cdFx0XHQvL2RlZmluZSBsb2NhbCB2YXJpYWJsc1xuXHRcdFx0dmFyIGkgPSAwO1xuXG5cdFx0XHQvL2l0ZXJhdGUgdGhyb3VnaCBhcnJheVxuXHRcdFx0JHNjb3BlLnVzZXJEYXRhLnJlY2lwaWFudExpc3QuZm9yRWFjaChmdW5jdGlvbihyZWNpcGlhbnQpIHtcblx0XHRcdFx0aWYocmVjaXBpYW50LnJlbGF0aW9uc2hpcCA9PSByZWxhdGlvbnNoaXApIHtcblx0XHRcdFx0XHQkc2NvcGUudXNlckRhdGEucmVjaXBpYW50TGlzdC5zcGxpY2UoaSwgMSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aSsrO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vcmV0dXJuIHJlc3VsdFxuXHRcdFx0cmV0dXJuIDA7XG5cdFx0fTtcblxuXHRcdGZ1bmN0aW9uIHNlbGVjdFJlY2lwaWFudChpbmRleCkge1xuXG5cdFx0XHQkc2NvcGUuc3RhdGUuc2VsZWN0ZWRSZWNpcGlhbnQgPSBpbmRleDtcblx0XHR9O1xuXG5cdFx0Ly92aWV3IG1vZGVsIGZ1bmN0aW9uc1xuXHRcdC8vVVBEQVRFIE9SREVSIFZJU0lCSUxJVFlcblx0XHQkc2NvcGUudXBkYXRlT3JkZXJWaXNpYmxpdHkgPSBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0Ly9kZWZpbmUgbG9jYWwgdmFyaWFsZXNcblx0XHRcdHZhciBoYXNoID0ge1wib25lXCI6IDEsIFwidHdvXCI6IDIsIFwidGhyZWVcIjogMywgXCJmb3VyXCI6IDR9O1xuXHRcdFx0XHRcblx0XHRcdC8vaXRlcmF0ZSB0aHJvdWdoIHZhbHVlc1xuXHRcdFx0T2JqZWN0LmtleXMoJHNjb3BlLnN0YXRlLm9yZGVyLnZpc2liaWxpdHkpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG5cdFx0XHRcdGlmKGhhc2hba2V5XSA8PSB2YWx1ZSkgJHNjb3BlLnN0YXRlLm9yZGVyLnZpc2liaWxpdHlba2V5XSA9IHRydWVcblx0XHRcdFx0XHRlbHNlICRzY29wZS5zdGF0ZS5vcmRlci52aXNpYmlsaXR5W2tleV0gPSBmYWxzZVxuXHRcdFx0fSk7XG5cblx0XHRcdC8vY29uc29sZS5sb2coJ2NoZWNraW5nIHZhbHVlcycsIHZhbHVlLCAkc2NvcGUuc3RhdGUub3JkZXIudmlzaWJpbGl0eSk7XG5cdFx0XHRcblx0XHR9O1xuXG5cdFx0Ly9VUERBVEUgRlJFUVVFTkNZXG5cdFx0JHNjb3BlLnVwZGF0ZUZyZXF1ZW5jeSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHQkc2NvcGUudXNlckRhdGEuc2hpcHBpbmdTY2hlZHVsZSA9IHNoaXBwaW5nU2NoZWR1bGVzW3ZhbHVlXTtcblx0XHR9O1xuXG5cdFx0Ly9VUERBVEUgT1JERVIgU0NIRURVTEVcblx0XHQkc2NvcGUudXBkYXRlT3JkZXJTY2hlZHVsZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHQvL2RlZmluZSBsb2NhbCB2YXJpYWJsZXNcblx0XHR9XG5cblx0XHQvL1VQREFURSBUSEUgU1VCU0NSSVBUSU9OIFRZUEVcblx0XHQkc2NvcGUudXBkYXRlU3ViVHlwZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHQvL2RlZmluZSBsb2NhbCB2YXJpYWJsZXNcblx0XHRcdHZhciB1cGRhdGVJbmRleCA9IDA7XG5cdFx0XHQkc2NvcGUudXNlckRhdGEuc3ViVHlwZSA9IHZhbHVlO1xuXG5cdFx0XHRpZih2YWx1ZT09XCJteXNlbGZcIikge1xuXHRcdFx0XHQvLyRzY29wZS5zdGF0ZS5yZWNpcGllbnRzQm94ID0gXCIxMFwiO1xuXHRcdFx0XHRhZGRUb1JlY2lwaWFudExpc3QoXCJNeXNlbGZcIik7XG5cdFx0XHRcdHJlbW92ZUZyb21SZWNpcGlhbnRMaXN0KFwiU29tZW9uZVwiKTtcblx0XHRcdFx0c2VsZWN0UmVjaXBpYW50KDApO1xuXHRcdFx0fSBlbHNlIGlmKHZhbHVlPT1cIm90aGVyc1wiKSB7XG5cdFx0XHRcdC8vJHNjb3BlLnN0YXRlLnJlY2lwaWVudHNCb3ggPSBcIjEwXCI7XG5cdFx0XHRcdHVwZGF0ZUluZGV4ID0gYWRkVG9SZWNpcGlhbnRMaXN0KFwiU29tZW9uZVwiKTtcblx0XHRcdFx0cmVtb3ZlRnJvbVJlY2lwaWFudExpc3QoXCJNeXNlbGZcIik7XG5cdFx0XHRcdHNlbGVjdFJlY2lwaWFudCgwKTtcblx0XHRcdH0gZWxzZSBpZih2YWx1ZT09XCJib3RoXCIpIHtcblx0XHRcdFx0Ly8kc2NvcGUuc3RhdGUucmVjaXBpZW50c0JveCA9IFwiMTBcIjtcblx0XHRcdFx0dXBkYXRlSW5kZXggPSBhZGRUb1JlY2lwaWFudExpc3QoXCJNeXNlbGZcIik7XG5cdFx0XHRcdGFkZFRvUmVjaXBpYW50TGlzdChcIlNvbWVvbmVcIik7XG5cdFx0XHRcdHNlbGVjdFJlY2lwaWFudCgwKTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0JHNjb3BlLnNlbGVjdFJlY2lwaWFudCA9IGZ1bmN0aW9uKGluZGV4KSB7XG5cdFx0XHRzZWxlY3RSZWNpcGlhbnQoaW5kZXgpO1xuXHRcdFx0JHNjb3BlLnN0YXRlLnRlbXBSZWNpcGlhbnQgPSAkc2NvcGUudXNlckRhdGEucmVjaXBpYW50TGlzdFtpbmRleF07XG5cdFx0fTtcblxuXHRcdCRzY29wZS51cGRhdGVSZWNpcGlhbnRWYWx1ZXMgPSBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBpbmRleCA9ICRzY29wZS5zdGF0ZS5zZWxlY3RlZFJlY2lwaWFudDtcblx0XHRcdCRzY29wZS51c2VyRGF0YS5yZWNpcGlhbnRMaXN0W2luZGV4XSA9ICRzY29wZS5zdGF0ZS50ZW1wUmVjaXBpYW50O1xuXHRcdH07XG5cblx0XHQkc2NvcGUudmFsaWRhdGVGb3JtID0gZnVuY3Rpb24oKSB7XG5cdFx0XHQvL2RlZmluZSBsb2NhbCB2YXJpYWJsZXNcblx0XHRcdC8vbm90aWZ5IHByb2dyZXNzXG5cdFx0XHRjb25zb2xlLmxvZygndmFsaWRhdGluZyBmb3JtJywgJHNjb3BlLnVzZXJEYXRhKTtcblx0XHRcdC8vZGlzcGxheSBlcnJvclxuXHRcdFx0JHNjb3BlLnN0YXRlLmVycm9ycy5taXNzaW5nUmVxdWlyZWQgPSB0cnVlO1xuXG5cdFx0XHQvL1xuXHRcdFx0c3VibWlzc2lvblNlcnZpY2Uuc3VibWl0KCRzY29wZS51c2VyRGF0YSkudGhlbihmdW5jdGlvbiBzdWNjZXNzKHJlc3BvbnNlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdnb3QgdGhpcyByZXNwb25zZScsIHJlc3BvbnNlKVxuXG5cdFx0XHR9KS5jYXRjaChmdW5jdGlvbiBlcnJvcihlKSB7XG5cblx0XHRcdH0pO1xuXHRcdH1cblx0XHRcblx0fTsiLCJcdGFuZ3VsYXIubW9kdWxlKCdhbnN1YicpLnNlcnZpY2UoJ21vZGFsU2VydmljZScsIG1vZGFsU2VydmljZSk7XG5cblx0LyogQG5nSW5qZWN0ICovXG5cdG1vZGFsU2VydmljZS4kaW5qZWN0ID0gWyckdWliTW9kYWwnXTtcblxuXHQvKiBAbmdJbmplY3QgKi9cblx0ZnVuY3Rpb24gbW9kYWxTZXJ2aWNlKCR1aWJNb2RhbCkge1xuXHRcdC8vZGVmaW5lIGxvY2FsIHZhcmlhYmxlc1xuXHRcdHZhciBtb2RhbERlZmF1bHRzID0ge1xuICAgICAgICAgICAgYmFja2Ryb3A6IHRydWUsXG4gICAgICAgICAgICBrZXlib2FyZDogdHJ1ZSxcbiAgICAgICAgICAgIG1vZGFsRmFkZTogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncGFydGlhbHMvbW9kYWwuaHRtJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBtb2RhbE9wdGlvbnMgPSB7XG4gICAgICAgICAgICBjbG9zZUJ1dHRvblRleHQ6ICdDbG9zZScsXG4gICAgICAgICAgICBhY3Rpb25CdXR0b25UZXh0OiAnT0snLFxuICAgICAgICAgICAgaGVhZGVyVGV4dDogJ1Byb2NlZWQ/JyxcbiAgICAgICAgICAgIGJvZHlUZXh0OiAnUGVyZm9ybSB0aGlzIGFjdGlvbj8nXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5zaG93TW9kYWwgPSBmdW5jdGlvbiAoY3VzdG9tTW9kYWxEZWZhdWx0cywgY3VzdG9tTW9kYWxPcHRpb25zKSB7XG4gICAgICAgICAgICBpZiAoIWN1c3RvbU1vZGFsRGVmYXVsdHMpIGN1c3RvbU1vZGFsRGVmYXVsdHMgPSB7fTtcbiAgICAgICAgICAgIGN1c3RvbU1vZGFsRGVmYXVsdHMuYmFja2Ryb3AgPSAnc3RhdGljJztcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNob3coY3VzdG9tTW9kYWxEZWZhdWx0cywgY3VzdG9tTW9kYWxPcHRpb25zKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbiAoY3VzdG9tTW9kYWxEZWZhdWx0cywgY3VzdG9tTW9kYWxPcHRpb25zKSB7XG4gICAgICAgICAgICAvL0NyZWF0ZSB0ZW1wIG9iamVjdHMgdG8gd29yayB3aXRoIHNpbmNlIHdlJ3JlIGluIGEgc2luZ2xldG9uIHNlcnZpY2VcbiAgICAgICAgICAgIHZhciB0ZW1wTW9kYWxEZWZhdWx0cyA9IHt9O1xuICAgICAgICAgICAgdmFyIHRlbXBNb2RhbE9wdGlvbnMgPSB7fTtcblxuICAgICAgICAgICAgLy9NYXAgYW5ndWxhci11aSBtb2RhbCBjdXN0b20gZGVmYXVsdHMgdG8gbW9kYWwgZGVmYXVsdHMgZGVmaW5lZCBpbiBzZXJ2aWNlXG4gICAgICAgICAgICBhbmd1bGFyLmV4dGVuZCh0ZW1wTW9kYWxEZWZhdWx0cywgbW9kYWxEZWZhdWx0cywgY3VzdG9tTW9kYWxEZWZhdWx0cyk7XG5cbiAgICAgICAgICAgIC8vTWFwIG1vZGFsLmh0bWwgJHNjb3BlIGN1c3RvbSBwcm9wZXJ0aWVzIHRvIGRlZmF1bHRzIGRlZmluZWQgaW4gc2VydmljZVxuICAgICAgICAgICAgYW5ndWxhci5leHRlbmQodGVtcE1vZGFsT3B0aW9ucywgbW9kYWxPcHRpb25zLCBjdXN0b21Nb2RhbE9wdGlvbnMpO1xuXG4gICAgICAgICAgICBpZiAoIXRlbXBNb2RhbERlZmF1bHRzLmNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICB0ZW1wTW9kYWxEZWZhdWx0cy5jb250cm9sbGVyID0gZnVuY3Rpb24gKCRzY29wZSwgJG1vZGFsSW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsT3B0aW9ucyA9IHRlbXBNb2RhbE9wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tb2RhbE9wdGlvbnMub2sgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxPcHRpb25zLmNsb3NlID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gJG1vZGFsLm9wZW4odGVtcE1vZGFsRGVmYXVsdHMpLnJlc3VsdDtcbiAgICAgICAgfTtcblx0XHRcblx0fTtcdCIsImFuZ3VsYXIubW9kdWxlKCdhbnN1YicpLnNlcnZpY2UoJ3N1Ym1pc3Npb25TZXJ2aWNlJywgc3VibWlzc2lvblNlcnZpY2UpO1xuXG5cdC8qIEBuZ0luamVjdCAqL1xuXHRzdWJtaXNzaW9uU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCddO1xuXG5cdC8qIEBuZ0luamVjdCAqL1xuXHRmdW5jdGlvbiBzdWJtaXNzaW9uU2VydmljZSgkaHR0cCkge1xuXHRcdC8vY29uc29sZS5sb2coJ3RoaXMgaXMgdGhlIHN1Ym1pc3Npb24gc2VydmljZScpO1xuXHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdHNlbGYuc3VibWl0ID0gZnVuY3Rpb24odXNlckRhdGEpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdzdWJtaXR0aW5nJywgdXNlckRhdGEpO1xuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0XHQvL3RyeSBQT1NUXG5cdFx0XHRcdCRodHRwKHtcblx0XHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdFx0XHR1cmw6ICcvc3Vic2NyaXB0aW9uLWFwcGxpY2F0aW9uLXN1Ym1pc3Npb24nLFxuXHRcdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGRhdGE6IHVzZXJEYXRhXG5cdFx0XHRcdH0pLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0cmVzb2x2ZShyZXNwb25zZSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH0sIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2soZXJyb3IpIHtcblx0XHRcdFx0XHRyZWplY3QoZXJyb3IpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0fTtcblxuXHR9OyIsImFuZ3VsYXIubW9kdWxlKCdhbnN1YicpLnNlcnZpY2UoJ3ppcGNvbXBsZXRlJywgemlwY29tcGxldGUpO1xuXHRcdFxuLyogQG5nSW5qZWN0ICovXG56aXBjb21wbGV0ZS4kaW5qZWN0ID0gW107XG5cbi8qIEBuZ0luamVjdCAqL1xuZnVuY3Rpb24gemlwY29tcGxldGUoKSB7XG5cdC8vZGVmaW5lIGxvY2FsIHZhcmFpYmxlc1xuXHR2YXIgc2VsZiA9IHRoaXM7XG5cdHZhciBjbGllbnRLZXkgPSBcIm1TYWpWWUQ4dXJGU09qVzN0dUpmaGRuU2pNcmV2a21nbFg0MFcyYnoxMkttNGNWSzV2WVpwb2dRZ1RjZnA2andcIjtcblx0dmFyIGNhY2hlID0ge307XG5cdC8vdmFyIGNvbnRhaW5lciA9ICQoXCIjZXhhbXBsZTFcIik7XG5cdC8vdmFyIGVycm9yRGl2ID0gY29udGFpbmVyLmZpbmQoXCJkaXYudGV4dC1lcnJvclwiKTtcblxuXHQvL2xvY2FsIGZ1bmN0aW9uIFxuXHRzZWxmLmhhbmRsZVJlc3AgPSBmdW5jdGlvbihkYXRhKSB7XG5cdFx0Ly8gQ2hlY2sgZm9yIGVycm9yXG5cdFx0aWYgKGRhdGEuZXJyb3JfbXNnKVxuXHRcdFx0Y29uc29sZS5sb2coZGF0YS5lcnJvcl9tc2cpO1xuXHRcdFx0Ly9lcnJvckRpdi50ZXh0KGRhdGEuZXJyb3JfbXNnKTtcblx0XHRlbHNlIGlmIChcImNpdHlcIiBpbiBkYXRhKVxuXHRcdHtcblx0XHRcdC8vIFNldCBjaXR5IGFuZCBzdGF0ZVxuXHRcdFx0Y29udGFpbmVyLmZpbmQoXCJpbnB1dFtuYW1lPSdjaXR5J11cIikudmFsKGRhdGEuY2l0eSk7XG5cdFx0XHRjb250YWluZXIuZmluZChcImlucHV0W25hbWU9J3N0YXRlJ11cIikudmFsKGRhdGEuc3RhdGUpO1xuXHRcdH0gXG5cdH07XG5cblx0Ly96aXAgY2hlY2tlclxuXHRzZWxmLmNoZWNrWmlwID0gZnVuY3Rpb24oZW50ZXJlZFppcCkge1xuXHRcdHZhciB6aXBjb2RlID0gZW50ZXJlZFppcC5zdWJzdHJpbmcoMCwgNSk7IFxuXG5cdFx0aWYgKHppcGNvZGUubGVuZ3RoID09IDUgJiYgL15bMC05XSskLy50ZXN0KHppcGNvZGUpKSB7XG5cblx0XHRcdGNvbnNvbGUubG9nKCdjaGVja2luZyB6aXAnLCB6aXBjb2RlKTtcblx0XHR9XHRcblx0XHRcblx0fTtcbn07XHQiXX0=
